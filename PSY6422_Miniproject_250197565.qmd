---
title: "PSY6422_Miniproject_250197565"
format: html
editor: visual
---

## Introduction

### Data Origins

The data set used for this mini-project was from a data paper titled [*'Data on Connection With the Natural Environment and Its Impact on Mental Health Among Allotment and Non-Allotment Owners'*](https://openpsychologydata.metajnl.com/articles/10.5334/jopd.122), by L. Haywood and J. Stiller(2024). The paper can be found on the [Journal of Open Psychology Data](https://openpsychologydata.metajnl.com/) website and the data set is available to download there.

The data was collected using an online survey from allotment and non-allotment owners with the aim of observing the relationship between well-being and engagement with activities in nature.

The questionnaire had items about demographics(age, gender, nationality), and questions regarding ownership and engagement in allotment activities, including time spent in nature and the types of outdoor activities. Along with that, mental health, self-esteem, physical health, connection to nature, social identity, loneliness, social support and self-efficacy were measured. A comprehensive guide of the items and scales used in the questionnaire can be found in the data paper on the Journal of Open Psychology Data website.

(Explain why these variables were chosen in brief)

The full, detailed codebook can be downloaded from the data paper under the 'Additional Files' section. Alternatively, it can be accessed by the [repository link](https://data.mendeley.com/datasets/8y2h89z46s/3) mentioned in the same paper.

### Research Question

Using the data set from the above paper, this mini-project will attempt to visualize the relationship between mental health, time spent in nature, and connection to nature, and any potential differences in men and women. and attempt to answer the question â€” 'Does time spent in nature improve mental health?'

### Data Preparation

The published data set has already been cleared of errors, outliers and required items have been reverse coded. The variables and column names are also compatible and easy to work with in R.

Data preparation will start with importing the data.

```{r}
#Install tidyverse in console for data wrangling
#Code--> install.packages("tidyverse")
library(tidyverse)

#Import dataset and create an object for easy management
#Use correct pathway as required 
#Only used csv file name here since it is already in the project folder
rawdata <- read_csv("connection_to_nature_data.csv")


```

Check the first few rows of the raw data set to make sure that the column names and values look good (this is not an issue in this data set since the authors have already cleaned the data for the most part). After that, check for any missing data.

```{r}
#To check the dataframe,including number of rows and columns
glimpse(rawdata)

#To see the first few rows of the dataframe as tibble use head()
#More readable but only shows the first 6 rows 
head(rawdata)

#To check for any missing data
colSums(is.na(rawdata))
#Another way do this : naniar to visualise the missing data
#Install the naniar package in console and load to visualise missing data
#Code--> install.packages("naniar)
library(naniar)
#Visualise missing data
vis_miss(rawdata)

```

**\<\<\<\<\<\<Crosschecking this with the dataframe on the environment showed that the missing data is not the work of missing observations or information in the dataframe, but just empty rows at the bottom.**

**While missing data here can be deleted using colSums(is.na() and drop_na(), it is not necessary here since most of the missing data is just a bunch of extra rows at the end of the dataframe that includes no data whatsoever. It is easier to simply avoid using it in the revised dataframe, and use na.rm = TRUE for the required columns when tidying the data.** \>\>\>\>\>\>

**EDIT THIS PART**

The next step is to tidy the data and create a new dataframe removing the missing data points and including only the required variables for the visualizations to answer the research question for this mini-project.

This involves creating new columns for the mean values for the Mental Health columns, Connection to Nature columns, and Self-efficacy columns. The data in the gender column will also have to be changed to 'male' and 'female' from their coded values. The column named D_hours will be used but does not require any modifications.

```{r}
#Create the revised dataframe as an object
revdata <- rawdata %>% 
  mutate( #create new columns with the mean values from the MH, Nat, SEff columns
    mean_mh = rowMeans(across(.cols = starts_with("MH")), na.rm = TRUE),
    mean_nat = rowMeans(across(.cols = starts_with("Nat")), na.rm = TRUE),
    mean_seff = rowMeans(across(.cols = starts_with("SEff")), na.rm = TRUE),
    #change numberical values to factors in the gender column 
    #check the codebook and use the correct values; 1=Man, 2=Women
    Gender = factor(D_Gender, levels = c(1,2), labels = c("Men", "Women"))
    ) %>% 
  #Select only the required columns for the revised dataframe
  select (c("Gender", "D_hours", "mean_mh", "mean_nat", "mean_seff")) %>%
  #to ignore any rows with missing values
  drop_na() 


#New dataframe should be visible in environment now
#Check if the changes have been made correctly
head(revdata)

  
```

### Visualizations

The aim is to create a scatter plot measuring the average mental health scores and its relationship with the hours spent in nature per week, along with the average connection to nature scores and the differences between genders.

Start with loading the necessary packages to do this.

```{r}
#install and load ggplot2 package
#Code in console--> install.packages("ggplot2)
#install plotly package for interactive graphs
#Code in console--> install.packages("plotly")
library(ggplot2)
library(plotly)

#Create the graph as an object 
p_scatter <- ggplot(data = revdata,aes(x = mean_mh, y = D_hours, color = mean_nat))+
  geom_point(alpha = 0.8) + #alpha value can be changed to adjust the opaqueness of the points
  geom_smooth(method = "lm", se = TRUE, color = "magenta", linewidth = 0.6)+
  #method draws a line to show correlation, se stands for standard deviation
  #lm is for a linear model to show a correlation
  labs(x = "Mean Mental Health Score",
       y = "Hours spent in Nature per week",
       color = "Connection to Nature",
       title = "Mental Health and Nature Exposure")+
  facet_wrap( ~ Gender)+ #makes columns seperated by gender
  scale_color_viridis_c(option = "cividis")+ #cividis to make it color-blind friendly and accessible
  theme_bw()
#To see the graph
p_scatter

#To make it an interactive graph
ggplotly(p_scatter)

```

In the above scatterplot, only two points can be seen in the NA section (the two data points are marked as non-binary in the dataframe). While the question was open-ended in the questionnaire, the codebook does not show a value the third gender was coded into. For this visualization, these two data points will be ignored since it does not seem of relevance with the data provided.

To do this, the previous data code for the revised data frame must be edited, and the code for the scatterplot can be run again.

```{r}
revdata <- rawdata %>% 
  mutate( 
    mean_mh = rowMeans(across(.cols = starts_with("MH")), na.rm = TRUE),
    mean_nat = rowMeans(across(.cols = starts_with("Nat")), na.rm = TRUE),
    mean_seff = rowMeans(across(.cols = starts_with("SEff")), na.rm = TRUE),
    Gender = factor(D_Gender, levels = c(1,2), labels = c("Men", "Women"))
    ) %>% 
  #Select only the required columns for the revised dataframe
  select (c("Gender", "D_hours", "mean_mh", "mean_nat", "mean_seff")) %>% 
  drop_na()%>% 
  filter(Gender == "Men" | Gender == "Women")
#this last step will filter and show only "Men" and "Women in the revdata 


#Running the scatterplot again
p_scatter <- ggplot(data = revdata,aes(x = mean_mh, y = D_hours, color = mean_nat))+
  geom_point(alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "black", linewidth = 0.6)+
  labs(x = "Mean Mental Health Score",
       y = "Hours spent in Nature per week",
       color = "Connection to Nature",
       title = "Mental Health and Nature Exposure")+
  facet_wrap( ~ Gender)+ 
  scale_color_viridis_c(option = "cividis")+
  theme_bw()

p_scatter
ggplotly(p_scatter)


```

\>\>\>\>\>\>\>Animate the graph

### Final Visualization 

### Summary

-   Brief thoughts on what you have learnt, what you might do next if you had more time / more data
